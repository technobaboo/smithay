<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Smithay: the Wayland compositor smithy"><title>smithay - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Regular-46f98efaafac5295.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceSerif4-Bold-a2c9cd1067f8b328.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-f3501f0f5ae15dfb.css" id="mainThemeStyle"><div id="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="smithay" data-themes="" data-resource-suffix="" data-rustdoc-version="1.71.0-nightly (1a5f8bce7 2023-05-26)" data-search-js="search-4926e5fc22a5646a.js" data-settings-js="settings-de11bff964e9d4e5.js" data-settings-css="settings-8c76f75bfb6bd192.css" data-theme-light-css="light-0f8c037637f9eb3e.css" data-theme-dark-css="dark-1097f8e92a01e3cf.css" data-theme-ayu-css="ayu-614652228113ac93.css" ></div><script src="../static.files/storage-62ce34ea385b278a.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-f0540c1d82cde29b.js"></script><noscript><link rel="stylesheet" media="(prefers-color-scheme:light)" href="../static.files/light-0f8c037637f9eb3e.css"><link rel="stylesheet" media="(prefers-color-scheme:dark)" href="../static.files/dark-1097f8e92a01e3cf.css"><link rel="stylesheet" href="../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../smithay/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../smithay/index.html"><img class="rust-logo" src="../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Crate smithay</a></h2><div class="sidebar-elems"><ul class="block"><li class="version">Version 0.3.0</li><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../static.files/wheel-7b819b6101059cd0.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">smithay</a><button id="copy-path" title="Copy item path to clipboard"><img src="../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../src/smithay/lib.rs.html#1-65">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="smithay-the-wayland-compositor-smithy"><a href="#smithay-the-wayland-compositor-smithy">Smithay: the Wayland compositor smithy</a></h2>
<p>This crate is a general framework for building wayland compositors. It currently focuses on low-level,
helpers and abstractions, handling most of the system-level and wayland protocol interactions.
The window management and drawing logic is however at the time not provided (but helpers for this
are planned for future version).</p>
<h3 id="structure-of-the-crate"><a href="#structure-of-the-crate">Structure of the crate</a></h3>
<p>The provided helpers are split into two main modules:</p>
<ul>
<li>
<p><a href="backend/index.html" title="mod smithay::backend"><code>backend</code></a> contains helpers for interacting with the operating
system, such as session management, interactions with the graphic stack
and input processing.</p>
</li>
<li>
<p><a href="wayland/index.html" title="mod smithay::wayland"><code>wayland</code></a> contains helpers for interacting with wayland clients
according to the wayland protocol.</p>
<p>In addition, the <a href="xwayland/index.html" title="mod smithay::xwayland"><code>xwayland</code></a> module contains helpers for managing an
XWayland instance if you want to support it. See the documentation of
these respective modules for information about their usage.</p>
</li>
</ul>
<h3 id="general-principles-for-using-smithay"><a href="#general-principles-for-using-smithay">General principles for using Smithay</a></h3><h4 id="the-event-loop-and-state-handling"><a href="#the-event-loop-and-state-handling">The event loop and state handling</a></h4>
<p>Smithay is built around [<code>calloop</code>], a callback-oriented event loop, which fits naturally with the
general behavior of a wayland compositor: waiting for events to occur and react to them (be it
client requests, user input, or hardware events such as <code>vblank</code>).</p>
<p>Using a callback-heavy structure however poses the question of state management: a lot of state needs
to be accessed from many different callbacks. To avoid an heavy requirement on shared pointers such
as <code>Rc</code> and <code>Arc</code> and the synchronization they require, [<code>calloop</code>] allows you to provide a mutable
reference to a value, that will be passed down to most callbacks. This structure provides
easy access to a centralized mutable state without synchronization (as the callback invocation is
<em>always</em> sequential), and is the recommended way to of structuring your compositor.
TODO: Add a section here how this links to wayland-server’s <code>Dispatch</code> and link to the wayland-server
docs, once they exist for 0.30.</p>
<p>Several objects, in particular on the wayland clients side, can exist as multiple instances where each
instance has its own associated state. For these situations, these objects provide an interface allowing
you to associate an arbitrary value to them, that you can access at any time from the object itself
(rather than having your own container in which you search for the appropriate value when you need it).</p>
<h4 id="logging"><a href="#logging">Logging</a></h4>
<p>TODO: docs about tracing</p>
</div></details><h2 id="modules" class="small-section-header"><a href="#modules">Modules</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="backend/index.html" title="mod smithay::backend">backend</a></div><div class="desc docblock-short">Backend (rendering/input) helpers</div></li><li><div class="item-name"><a class="mod" href="desktop/index.html" title="mod smithay::desktop">desktop</a></div><div class="desc docblock-short">Desktop management helpers</div></li><li><div class="item-name"><a class="mod" href="input/index.html" title="mod smithay::input">input</a></div><div class="desc docblock-short">Input abstractions</div></li><li><div class="item-name"><a class="mod" href="output/index.html" title="mod smithay::output">output</a></div><div class="desc docblock-short">Output</div></li><li><div class="item-name"><a class="mod" href="reexports/index.html" title="mod smithay::reexports">reexports</a></div><div class="desc docblock-short">Reexports of crates, that are part of the public api, for convenience</div></li><li><div class="item-name"><a class="mod" href="utils/index.html" title="mod smithay::utils">utils</a></div><div class="desc docblock-short">Various utilities functions and types</div></li><li><div class="item-name"><a class="mod" href="wayland/index.html" title="mod smithay::wayland">wayland</a></div><div class="desc docblock-short">Protocol-related utilities</div></li><li><div class="item-name"><a class="mod" href="xwayland/index.html" title="mod smithay::xwayland">xwayland</a></div><div class="desc docblock-short">XWayland utilities</div></li></ul><h2 id="macros" class="small-section-header"><a href="#macros">Macros</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.delegate_compositor.html" title="macro smithay::delegate_compositor">delegate_compositor</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_content_type.html" title="macro smithay::delegate_content_type">delegate_content_type</a></div><div class="desc docblock-short">Macro to delegate implementation of the wp content type protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_data_device.html" title="macro smithay::delegate_data_device">delegate_data_device</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_dmabuf.html" title="macro smithay::delegate_dmabuf">delegate_dmabuf</a></div><div class="desc docblock-short">Macro to delegate implementation of the linux dmabuf to <a href="wayland/dmabuf/struct.DmabufState.html" title="struct smithay::wayland::dmabuf::DmabufState"><code>DmabufState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_fractional_scale.html" title="macro smithay::delegate_fractional_scale">delegate_fractional_scale</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_idle_inhibit.html" title="macro smithay::delegate_idle_inhibit">delegate_idle_inhibit</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_input_method_manager.html" title="macro smithay::delegate_input_method_manager">delegate_input_method_manager</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_kde_decoration.html" title="macro smithay::delegate_kde_decoration">delegate_kde_decoration</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_keyboard_shortcuts_inhibit.html" title="macro smithay::delegate_keyboard_shortcuts_inhibit">delegate_keyboard_shortcuts_inhibit</a></div><div class="desc docblock-short">Macro to delegate implementation of the keyboard shortcuts inhibit protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_layer_shell.html" title="macro smithay::delegate_layer_shell">delegate_layer_shell</a></div><div class="desc docblock-short">Macro to delegate implementation of wlr layer shell to <a href="wayland/shell/wlr_layer/struct.WlrLayerShellState.html" title="struct smithay::wayland::shell::wlr_layer::WlrLayerShellState"><code>WlrLayerShellState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_output.html" title="macro smithay::delegate_output">delegate_output</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_presentation.html" title="macro smithay::delegate_presentation">delegate_presentation</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_primary_selection.html" title="macro smithay::delegate_primary_selection">delegate_primary_selection</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_relative_pointer.html" title="macro smithay::delegate_relative_pointer">delegate_relative_pointer</a></div><div class="desc docblock-short">Macro to delegate implementation of the relative pointer protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_seat.html" title="macro smithay::delegate_seat">delegate_seat</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_shm.html" title="macro smithay::delegate_shm">delegate_shm</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_tablet_manager.html" title="macro smithay::delegate_tablet_manager">delegate_tablet_manager</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_text_input_manager.html" title="macro smithay::delegate_text_input_manager">delegate_text_input_manager</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_viewporter.html" title="macro smithay::delegate_viewporter">delegate_viewporter</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_virtual_keyboard_manager.html" title="macro smithay::delegate_virtual_keyboard_manager">delegate_virtual_keyboard_manager</a></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_activation.html" title="macro smithay::delegate_xdg_activation">delegate_xdg_activation</a></div><div class="desc docblock-short">Macro to delegate implementation of the xdg activation to <a href="wayland/xdg_activation/struct.XdgActivationState.html" title="struct smithay::wayland::xdg_activation::XdgActivationState"><code>XdgActivationState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_decoration.html" title="macro smithay::delegate_xdg_decoration">delegate_xdg_decoration</a></div><div class="desc docblock-short">Macro to delegate implementation of the xdg decoration to <a href="wayland/shell/xdg/decoration/struct.XdgDecorationState.html" title="struct smithay::wayland::shell::xdg::decoration::XdgDecorationState"><code>XdgDecorationState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_shell.html" title="macro smithay::delegate_xdg_shell">delegate_xdg_shell</a></div></li><li><div class="item-name"><a class="macro" href="macro.egl_platform.html" title="macro smithay::egl_platform">egl_platform</a></div><div class="desc docblock-short">Create a <code>EGLPlatform&lt;'a&gt;</code> for the provided platform.</div></li><li><div class="item-name"><a class="macro" href="macro.render_elements.html" title="macro smithay::render_elements">render_elements</a></div><div class="desc docblock-short">Aggregate multiple types implementing <a href="backend/renderer/element/trait.RenderElement.html" title="trait smithay::backend::renderer::element::RenderElement"><code>RenderElement</code></a> into a single enum type</div></li><li><div class="item-name"><a class="macro" href="macro.space_elements.html" title="macro smithay::space_elements">space_elements</a></div><div class="desc docblock-short">Aggregate multiple types implementing <a href="desktop/space/trait.SpaceElement.html" title="trait smithay::desktop::space::SpaceElement"><code>SpaceElement</code></a> into a single enum type to be used
with a <a href="desktop/space/struct.Space.html" title="struct smithay::desktop::space::Space"><code>Space</code></a>.</div></li></ul></section></div></main></body></html>